<ul id="navigation">
	<li class="close">Close Panel</li>
	<li class="back">&laquo; Back</li>
</ul>

<h1>SQL Explain</h1>
<div class="container">
	<dl>
		<dt>Query:</dt>
		<dd class="sql-query" style="white-space:pre-wrap;">{{ sql|escape|linebreaksbr }}</dd>
		<dt>Parameters:</dt>
		<dd>{{ params|join:", "|escape }}</dd>
	</dl>
</div>
<table class="data" border="0" cellspacing="0" cellpadding="0"> 
	<thead>
		<tr>
		{% for header in headers %}
			<th>{{ header|title|escape }}</th>
		{% endfor %}
		</tr>
	</thead>
	<tbody>
	{% for row in explain %}
		<tr class="{% cycle 'odd' 'even' %}">
		{% for value in row %}
			<td>{{ value|escape }}</td>
		{% endfor %}
		</tr>
	{% endfor %}
	</tbody>
</table>

<h1>Traceback</h1>
<div class="container">
	<ul class="traceback" id="sql_explain_traceback">
	</ul>
</div>
<script type="text/javascript">
var traceback = $('#sql_explain_traceback');
$(globalLocals.stack).each(function(index)
{
	traceback.append('<li>'+this+'</li>');
});
traceback.find('li:odd').addClass('odd');

var ref = $('.sql-query');
var sqlArray = ref.text().split(/(ANALYZE|MATCH|AGAINST|ALL|ASC|AS|ALTER|AND|ADD|AUTO_INCREMENT|BETWEEN|BINARY|BOTH|BY|BOOLEAN|CHANGE|CHECK|COLUMNS|COLUMN|CROSS|CREATE|DATABASES|DATABASE|DATA|DELAYED|DESCRIBE|DESC|DISTINCT|DELETE|DROP|DEFAULT|ENCLOSED|ESCAPED|EXISTS|EXPLAIN|FIELDS|FIELD|FLUSH|FOR|FOREIGN|FUNCTION|FROM|GROUP|GRANT|HAVING|IGNORE|INDEX|INFILE|INSERT|INNER JOIN|INTO|IDENTIFIED|IN|IS|IF|JOIN|KEYS|KILL|KEY|LEADING|LIKE|LIMIT|LINES|LOAD|LOCAL|LOCK|LOW_PRIORITY|LEFT JOIN|LANGUAGE|MODIFY|NATURAL|NOT|NULL|NEXTVAL|OPTIMIZE|OPTION|OPTIONALLY|ORDER BY|OUTFILE|OR|OUTER JOIN|ON|PROCEEDURE|PROCEDURAL|PRIMARY|READ|REFERENCES|REGEXP|RENAME|REPLACE|RETURN|REVOKE|RLIKE|RIGHT JOIN|SHOW|SONAME|STATUS|STRAIGHT_JOIN|SELECT|SETVAL|SET|TABLES|TEMINATED|TO|TRAILING|TRUNCATE|TABLE|TEMPORARY|TRIGGER|TRUSTED|UNIQUE|UNLOCK|USE|USING|UPDATE|VALUES|VARIABLES|VIEW|WITH|WRITE|WHERE|ZEROFILL|TYPE|XOR)/);
var html= '<table border="0" cellspacing="0" cellpadding="0">'
	$(sqlArray).each(function(i)
	{
		if (i%2!=0)
		{
			html = html+'<tr><td class="description"><strong>'+this+'</strong><td>';
		}
		else
		{
			html = html+'<td>'+this+'</td></tr>';
		}
	});
html= html+'</table>'
ref.html(html);
</script>